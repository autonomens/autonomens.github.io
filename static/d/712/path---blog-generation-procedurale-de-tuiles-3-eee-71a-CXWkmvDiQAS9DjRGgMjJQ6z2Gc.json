{"data":{"markdownRemark":{"id":"15c7f0db-2f6a-5d37-bed3-b920443a30c0","html":"<p>Cette carte de Toulouse a été créée à partir de données provenant de OpenStreetMap ; la zone affichée se situe à Toulouse et ses environs.</p>\n<h2>Affichage des zones d'occupation des sols</h2>\n<p>Je choisis de simplifier la représentation de l'occupation des sols en grands groupes : residentiel, commercial, industriel, naturel :</p>\n<pre><code>SELECT ST_Simplify(way,50) as way,landuse,way_area,\nCASE\nWHEN landuse = 'residential' THEN 'residential'\nWHEN landuse IN ('commercial','retail') THEN 'commercial'\nWHEN landuse = 'industrial' THEN 'industrial'\nWHEN landuse = 'cemetery' THEN 'cemetery'\nWHEN landuse IN ('farm','farmland','farmyard','forest','grass','vineyard') THEN 'natural'\nELSE 'autres'\nEND AS type\nFROM (SELECT * FROM planet_osm_polygon WHERE landuse IS NOT NULL) as zones\n</code></pre>\n<p>Je crée des textures sous GIMP que j'applique aux couches concernées.</p>\n<p><img src=\"https://makina-corpus.com/blog/metier/images/dessin-toulouse-zones-trames\"></p>\n<p>Les bords sont trop rectilignes, j'ajoute deux contours avec du line-smooth afin de casser cela :</p>\n<pre><code>#zones {\n    ::outline1 {\n         line-smooth:2;\n         line-color:@crayon;\n         line-width:1;\n         [zoom>=15] {line-width:0.4;}\n         line-opacity:0.5;\n    }\n    ::outline2 [zoom&#x3C;15] {\n         line-smooth:3;\n         line-color:@crayon;\n         line-width:0.8;\n         line-opacity:0.3;\n    }\n}\n</code></pre>\n<p><img src=\"https://makina-corpus.com/blog/metier/images/copy_of_dessintlsart3zonestramescontours.jpg\"></p>\n<h2>Affichage des cours d'eau</h2>\n<p>Sans intervention ces tracés sont très rectilignes. Ce sont sans doute les plus difficiles à « casser ». Etant donné que les cours d'eau ont tendance à traverser une carte entière, ils attirent davantage l'attention que des éléments plus ponctuels.</p>\n<p><img src=\"https://makina-corpus.com/blog/metier/images/dessintlsart3eaux.jpg\"></p>\n<p>Plutôt qu'appliquer une couleur de fond, je crée une nouvelle texture de crayonnage, beaucoup moins dense :</p>\n<p><img src=\"https://makina-corpus.com/blog/metier/images/dessin-toulouse-eaux-textures\"></p>\n<p>Le résultat ne plaît pas encore : les bords sont trop lisses. Je crée donc une deuxième requête PostGIS, pour appeler les mêmes données avec un buffer :</p>\n<pre><code>SELECT ST_Buffer(way,50) as way, waterway AS type FROM planet_osm_polygon WHERE waterway='riverbank'\n</code></pre>\n<p>J'applique à cette couche une nouvelle texture basée sur la première, mais encore plus légère :</p>\n<p><img src=\"https://makina-corpus.com/blog/metier/images/dessintlsart3eauxtexturesbuffer.jpg\"></p>\n<p>J'arrive ainsi au résultat que je cherche : la reproduction d'un crayonnage rapide, débordant des limites d'origine. Je n'ai ensuite plus qu'à appliquer un contour.</p>\n<p><img src=\"https://makina-corpus.com/blog/metier/images/dessin-toulouse-eaux-contours\"></p>\n<p>Je peux maintenant assembler toutes les données sélectionnées : types d'occupation des sols, cours d'eau, bâtiments...</p>\n<p><img src=\"https://makina-corpus.com/blog/metier/images/dessin-toulouse-final\"></p>","frontmatter":{"date":"March 03, 2017","title":"Dessiner une ville à la main avec TileMill (3 – Occupation des sols et cours d'eau)","description":"Nous avons vu comment représenter les bâtiments. Je m'intéresse maintenant à la mise en forme des zones d'occupation des sols et des cours d'eau pour finaliser la représentation de Toulouse et des villes environnantes.","tags":["carto","tilemill"]}}},"pageContext":{"id":"15c7f0db-2f6a-5d37-bed3-b920443a30c0"}}